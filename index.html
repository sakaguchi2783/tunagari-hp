<!DOCTYPE html>  
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>つながりリフォームバトン工房</title>
  <meta name="description" content="つながりリフォームバトン工房｜建築塗装・仮設足場・手形思い出外壁工事・タイムカプセル外壁工事・外装リフォーム全般" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 rx=%2218%22 fill=%22%230b1b14%22/><text x=%2250%22 y=%2270%22 font-size=%2270%22 text-anchor=%22middle%22 fill=%22%23fff%22>OW</text></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f12;
      --panel:#0e1419;
      --ink:#e6f2ec;
      --muted:#a9b7ae;
      --brand:#1ea672;       /* グリーン */
      --brand-2:#8b5a2b;     /* ブラウン */
      --line:rgba(255,255,255,.08);
      --shadow:0 10px 25px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.02);
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{
      margin:0;
      background:
        radial-gradient(1200px 600px at 80% -10%,rgba(30,166,114,.15),transparent 55%),
        radial-gradient(900px 400px at 10% 110%,rgba(139,90,43,.12),transparent 60%),
        var(--bg);
      color:var(--ink);
      font-family:"Noto Sans JP","Outfit",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue","Hiragino Kaku Gothic ProN","Hiragino Sans",Meiryo,sans-serif;
      scroll-behavior:smooth
    }
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}

    /* ====== Header / Nav ====== */
    .nav{
      position:sticky;top:0;z-index:50;backdrop-filter:blur(8px);
      background:linear-gradient(180deg, rgba(4,7,9,.7), rgba(4,7,9,.35));
      border-bottom:1px solid var(--line);
      transition:transform .35s ease, box-shadow .35s ease;
      will-change:transform;
    }
    .nav.nav--hide{transform:translateY(-110%)}
    .nav-inner{max-width:1200px;margin:auto;display:flex;align-items:center;gap:20px;padding:12px 20px}
    .brand{display:flex;align-items:center;gap:12px}
    .brand img{width:46px;height:46px;object-fit:contain;filter:drop-shadow(0 6px 10px rgba(0,0,0,.25))}
    .brand h1{font:600 18px/1 "Outfit";letter-spacing:2px}
    .brand small{display:block;font:500 12px/1 "Noto Sans JP";color:var(--muted)}
    .menu{margin-left:auto;display:flex;gap:6px;align-items:center}
    .menu a{
      padding:10px 14px;border-radius:999px;border:1px solid transparent;
      font:600 14px/1 "Outfit";letter-spacing:.5px;position:relative;opacity:.92
    }
    .menu a:hover{border-color:var(--line);opacity:1}
    .menu a::after{
      content:"";position:absolute;left:12px;right:12px;bottom:6px;height:2px;border-radius:2px;
      background:linear-gradient(90deg,transparent, var(--brand) 40%, var(--brand-2) 60%, transparent);
      transform:scaleX(0);transform-origin:left;transition:.35s ease
    }
    .menu a:hover::after{transform:scaleX(1)}
    .cta{
      background:linear-gradient(135deg,var(--brand),#23c48b);color:#02110a;border:none !important;
      box-shadow:0 6px 20px rgba(30,166,114,.35);font-weight:800
    }
    .burger{display:none;margin-left:8px}
    .burger button{
      background:transparent;border:1px solid var(--line);border-radius:10px;padding:10px;color:var(--ink)
    }

    /* ===== Mobile drawer ===== */
    @media (max-width:980px){
      .menu{display:none}
      .burger{display:block}
      /* 左からスライドするドロワー */
      .menu-mobile{
        position:fixed;inset:0 auto 0 0;
        width:min(78%,320px);
        display:block;
        padding:16px;
        border-right:1px solid var(--line);
        background:rgba(6,9,11,.98);
        transform:translateX(-105%);
        transition:transform .35s ease;
        z-index:60;
        overflow:auto;
      }
      .menu-mobile.open{transform:translateX(0)}
      .menu-mobile a{display:block;padding:14px;border:1px solid var(--line);border-radius:12px;margin-bottom:8px}
      .menu-mobile .cta{border-color:transparent}
      .scrim{
        position:fixed;inset:0;background:rgba(0,0,0,.35);backdrop-filter:blur(1px);
        z-index:55;
      }
      .scrim[hidden]{display:none}
      body.menu-open{overflow:hidden}
    }

    /* ====== Hero ====== */
    .hero{
      position:relative;isolation:isolate;overflow:hidden;
      border-bottom:1px solid var(--line)
    }
    .hero-inner{max-width:1200px;margin:auto;padding:80px 20px 90px;display:grid;grid-template-columns:1.1fr .9fr;gap:28px;align-items:center}
    .hero h2{font:800 40px/1.15 "Outfit";letter-spacing:.5px;margin:0 0 14px}
    .hero p{color:var(--muted);margin:0 0 24px;font-size:16px}
    .pill{
      display:inline-flex;gap:10px;align-items:center;border:1px solid var(--line);padding:10px 14px;border-radius:999px;margin-bottom:16px;background:rgba(255,255,255,.02)
    }
    .pill b{color:var(--brand)}
    .hero-cta{display:flex;gap:12px;flex-wrap:wrap}
    .btn{
      padding:14px 18px;border-radius:14px;border:1px solid var(--line);background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,0));
      color:var(--ink);font-weight:700;box-shadow:var(--shadow)
    }
    .btn.primary{background:linear-gradient(135deg,var(--brand),#23c48b);color:#03110a;border-color:transparent}
    .btn.ghost:hover{border-color:rgba(255,255,255,.25)}

    /* アイコン付き特別ボタン */
    .btn.icon{
      display:inline-flex;align-items:center;gap:10px;font-weight:800;letter-spacing:.3px;
      border:1px solid rgba(255,255,255,.12);
      background:linear-gradient(135deg, rgba(255,255,255,.04), rgba(255,255,255,.01));
    }
    .btn.icon svg{width:20px;height:20px;flex:0 0 auto}

    /* アプリアイコン風（丸角の角丸大きめ） */
    .btn.app{
      border-radius:16px;
      background:linear-gradient(135deg,#22c48b 0%, #16a374 60%, #119a6d 100%);
      color:#03110a;border-color:transparent;
      box-shadow:0 8px 24px rgba(34,196,139,.35);
    }

    /* YouTube 風ボタン */
    .btn.yt{
      background:linear-gradient(135deg, #ff4444, #d62828);
      color:#fff;border-color:transparent;
      box-shadow:0 8px 24px rgba(214,40,40,.35);
    }

    .kside{
      border:1px solid var(--line);border-radius:18px;background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01));
      padding:16px;box-shadow:var(--shadow)
    }
    .grid-kpis{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    .kpi{
      padding:18px;border-radius:14px;border:1px solid var(--line);background:linear-gradient(180deg,rgba(255,255,255,.02),transparent)
    }
    .kpi h3{margin:0;font:800 28px/1 "Outfit"}
    .kpi p{margin:6px 0 0;color:var(--muted);font-size:12px}
    .hero .shape{
      position:absolute;inset:auto -10%  -30%  -10%; height:60%; z-index:-1;
      background:radial-gradient(40% 60% at 20% 50%, rgba(30,166,114,.16), transparent 60%),
                 radial-gradient(40% 60% at 80% 50%, rgba(139,90,43,.14), transparent 60%);
      filter:blur(40px)
    }
    @media (max-width:980px){
      .hero-inner{grid-template-columns:1fr; padding:54px 20px 70px}
      .hero h2{font-size:32px}
    }

    /* ====== Sections ====== */
    section{scroll-margin-top:90px}
    .wrap{max-width:1200px;margin:auto;padding:80px 20px}
    .section-head{display:flex;justify-content:space-between;align-items:end;gap:20px;margin-bottom:26px}
    .section-head h3{margin:0;font:800 26px/1 "Outfit";letter-spacing:.6px}
    .section-head p{margin:8px 0 0;color:var(--muted)}
    .tag{display:inline-block;padding:6px 10px;border-radius:999px;border:1px solid var(--line);font:600 12px/1 "Outfit";color:var(--muted)}
    .grid{display:grid;gap:18px}
    .grid.cards{grid-template-columns:repeat(3,1fr)}
    @media (max-width:980px){.grid.cards{grid-template-columns:1fr}}
    .card{
      position:relative;border:1px solid var(--line);border-radius:18px;overflow:hidden;
      background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01));
      transition:.35s;box-shadow:var(--shadow)
    }
    .card:hover{transform:translateY(-2px);border-color:rgba(255,255,255,.2)}
    .card .thumb{height:180px;background:
      radial-gradient(500px 120px at 20% 120%, rgba(30,166,114,.18), transparent 60%),
      linear-gradient(135deg, rgba(139,90,43,.25), rgba(139,90,43,0) 40%),
      linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.0));
      border-bottom:1px solid var(--line)
    }
    .card .body{padding:18px}
    .card h4{margin:0 0 8px;font:700 18px/1.25 "Noto Sans JP"}
    .card p{margin:0;color:var(--muted);font-size:14px}

    /* ====== About ====== */
    .about{
      display:grid;grid-template-columns:1.1fr .9fr;gap:22px
    }
    .about .panel{
      border:1px solid var(--line);border-radius:18px;padding:22px;background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01));box-shadow:var(--shadow)
    }
    .kv{
      border:1px dashed rgba(255,255,255,.15);border-radius:14px;padding:16px;display:flex;gap:14px;align-items:center;background:rgba(255,255,255,.02)
    }
    .kv strong{font:800 26px/1 "Outfit";color:var(--brand)}
    .kv span{color:var(--muted)}
    .data{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:14px}
    .data .item{border:1px solid var(--line);border-radius:12px;padding:12px}
    .data .item b{display:block;font:800 20px/1 "Outfit"}
    .data .item small{color:var(--muted)}

    @media (max-width:980px){.about{grid-template-columns:1fr}}

    /* ====== Blog (Recruit置換) ====== */
    .blog{
      display:grid;grid-template-columns:1fr 1fr;gap:18px
    }
    @media (max-width:980px){.blog{grid-template-columns:1fr}}
    .post-form{
      border:1px solid var(--line);border-radius:18px;padding:20px;background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01));box-shadow:var(--shadow)
    }
    .post-form h4{margin:0 0 6px}
    .post-form .hint{margin-top:6px}
    .post-list{
      display:grid;grid-template-columns:repeat(2,1fr);gap:16px
    }
    @media (max-width:980px){.post-list{grid-template-columns:1fr}}
    .post{
      border:1px solid var(--line);border-radius:16px;overflow:hidden;background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.0));
      box-shadow:var(--shadow)
    }
    .post .ph{height:180px;background:#0a0f12;display:flex;align-items:center;justify-content:center}
    .post .ph img{width:100%;height:100%;object-fit:cover}
    .post .body{padding:14px}
    .post .title{font:700 16px/1.3 "Noto Sans JP";margin:0 0 6px}
    .post .text{color:var(--muted);font-size:14px;margin:0 0 10px;white-space:pre-wrap}
    .post .meta{color:var(--muted);font-size:12px}
    .btn.small{padding:10px 12px;border-radius:10px;font-size:13px}
    .more{margin-top:14px;display:flex}
    .more .btn{margin:auto}

    /* ====== Footer ====== */
    footer{
      border-top:1px solid var(--line);padding:26px 20px;color:var(--muted);background:linear-gradient(180deg,rgba(255,255,255,.02),transparent)
    }
    .foot{max-width:1200px;margin:auto;display:flex;gap:18px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .foot .mini{display:flex;gap:12px;align-items:center}
    .foot img{width:36px;height:36px}
    .copyright{font-size:12px}

    /* ====== Reveal animation ====== */
    .reveal{opacity:0;transform:translateY(12px);transition:all .65s cubic-bezier(.2,.7,.2,1)}
    .reveal.show{opacity:1;transform:none}
  </style>
</head>
<body>

  <!-- ====== NAV ====== -->
  <header class="nav" id="siteNav">
    <div class="nav-inner">
      <a class="brand" href="#home" aria-label="つながりリフォームバトン工房">
        <img src="assets/ogura-logo.png" alt="ロゴ" style="width: 200px; height: auto;">
      </a>
      <nav class="menu" aria-label="主なメニュー">
        <a href="#home">ホーム</a>
        <a href="#services">事業内容</a>
        <a href="#about">会社概要</a>
        <a href="#blog">ブログ</a>
        <a class="cta" href="#contact">お問い合わせ</a>
      </nav>
      <div class="burger">
        <button id="btnBurger" aria-expanded="false" aria-controls="mobileMenu" aria-label="メニュー">≡</button>
      </div>
    </div>
    <!-- 左ドロワー -->
    <nav id="mobileMenu" class="menu-mobile" aria-label="モバイルメニュー" hidden>
      <a href="#home">ホーム</a>
      <a href="#services">事業内容</a>
      <a href="#about">会社概要</a>
      <a href="#blog">ブログ</a>
      <a class="cta" href="#contact">お問い合わせ</a>
    </nav>
    <div id="scrim" class="scrim" hidden></div>
  </header>

  <!-- ====== HERO ====== -->
  <section id="home" class="hero">
    <div class="hero-inner">
      <div class="copy reveal">
        <div class="pill"><span class="tag">Craft & Innovation</span> <b>つながりリフォームバトン工房</b></div>
        <h2>‟生きた証”をカタチに…<br>家族を繋ぎ、地域を繋ぐ。</h2>
        <p>
          建築塗装・仮設足場・手形思い出外壁工事・タイムカプセル外壁工事・外装リフォーム全般まで。<br>
          私たちは、丁寧な診断と確かな施工で「長く愛される住まい」を実現します。
        </p>
        <div class="hero-cta">
          <a class="btn primary" href="#services">事業内容を見る</a>
          <a class="btn icon app" href="https://example.com/app" target="_blank" rel="noopener" aria-label="アプリへ">
            <!-- アプリアイコン風（家＋矢印） -->
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 3l8 6v10a2 2 0 0 1-2 2h-3v-6H9v6H6a2 2 0 0 1-2-2V9l8-6z" fill="currentColor" opacity=".9"/>
              <path d="M13 11h5M16 8l3 3-3 3" stroke="#052b1f" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            アプリへ
          </a>
          <a class="btn ghost" href="#blog">ブログを見る</a>
        </div>
      </div>
      <aside class="kside reveal" aria-label="実績概況">
        <div class="grid-kpis">
          <div class="kpi">
            <h3>300+</h3><p>累計施工案件</p>
          </div>
          <div class="kpi">
            <h3>98%</h3><p>お客様満足度（自社アンケート）</p>
          </div>
          <div class="kpi">
            <h3>20年</h3><p>外装・塗装の専門キャリア</p>
          </div>
          <div class="kpi">
            <h3>0→1</h3><p>調査から施工まで一貫体制</p>
          </div>
        </div>
      </aside>
    </div>
    <div class="shape" aria-hidden="true"></div>
  </section>

  <!-- ====== SERVICES ====== -->
  <section id="services" class="wrap">
    <div class="section-head">
      <div>
        <h3>事業内容</h3>
        <p>多様な要件に合わせ、調査・設計・施工・アフターまでワンストップで対応します。</p>
      </div>
      <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap">
        <a class="btn icon yt" href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" target="_blank" rel="noopener" aria-label="YouTubeで動画を見る">
          <!-- 再生アイコン -->
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <rect x="3" y="5" width="18" height="14" rx="3" fill="currentColor" opacity=".95"></rect>
            <polygon points="10,9 16,12 10,15" fill="#fff"></polygon>
          </svg>
          動画で見る
        </a>
        <span class="tag">Services</span>
      </div>
    </div>

    <div class="grid cards">
      <article class="card reveal">
        <div class="thumb" role="img" aria-label="建築塗装のイメージ"></div>
        <div class="body">
          <h4>建築塗装</h4>
          <p>外壁・屋根・付帯部の塗装。劣化診断から下地補修、高耐候塗料の選定・施工まで一貫対応。美観と耐久性をバランス良く実現します。</p>
        </div>
      </article>

      <article class="card reveal">
        <div class="thumb" role="img" aria-label="仮設足場のイメージ"></div>
        <div class="body">
          <h4>仮設足場</h4>
          <p>安全第一の足場を自社手配。近隣配慮・飛散防止・動線計画を徹底し、法令遵守のもと高所作業の品質と安全を確保します。</p>
        </div>
      </article>

      <article class="card reveal">
        <div class="thumb" role="img" aria-label="手形思い出外壁工事のイメージ"></div>
        <div class="body">
          <h4>手形思い出外壁工事</h4>
          <p>ご家族の手形を外壁に残すメモリアル施工。専用下地とトップコートで色持ち・耐候性に配慮し、思い出を美しく長く残します。</p>
        </div>
      </article>

      <article class="card reveal">
        <div class="thumb" role="img" aria-label="タイムカプセル外壁工事のイメージ"></div>
        <div class="body">
          <h4>タイムカプセル外壁工事</h4>
          <p>外壁に専用ボックスを設置し、プレートを施工。安全性・防水性・将来の開封計画まで設計し、家族の物語を未来へつなぎます。</p>
        </div>
      </article>

      <article class="card reveal">
        <div class="thumb" role="img" aria-label="外装リフォーム全般のイメージ"></div>
        <div class="body">
          <h4>外装リフォーム全般</h4>
          <p>サイディング張替・シーリング・雨樋・屋根改修など、住まいの外装をトータルでメンテナンス。ご予算と効果を最適化します。</p>
        </div>
      </article>

      <article class="card reveal">
        <div class="thumb" role="img" aria-label="ワンストップ体制のイメージ"></div>
        <div class="body">
          <h4>調査から施工まで一貫対応</h4>
          <p>現地調査 → ご提案・お見積り → 足場・施工 → 仕上げ検査 → アフターまで。工程を一本化し、品質・スピード・安心を両立します。</p>
        </div>
      </article>
    </div>
  </section>

  <!-- ====== ABOUT ====== -->
  <section id="about" class="wrap">
    <div class="section-head">
      <div>
        <h3>会社概要</h3>
        <p>地域に根ざし、誠実に、丁寧に。価値が長続きする住まいづくりを目指しています。</p>
      </div>
      <span class="tag">About</span>
    </div>

    <div class="about">
      <div class="panel reveal">
        <div class="kv">
          <img src="assets/ogura-logo.png" alt="ロゴ" style="width: 150px; height: auto;">
          <div></div>
        </div>
        <div class="data">
          <div class="item"><b>代表</b><small>（サンプル）</small></div>
          <div class="item"><b>所在地</b><small>（サンプル）兵庫県明石市</small></div>
          <div class="item"><b>設立</b><small>2025年</small></div>
          <div class="item"><b>事業</b><small>建築塗装／仮設足場／手形思い出外壁工事／タイムカプセル外壁工事／外装リフォーム全般</small></div>
        </div>
      </div>

      <div class="panel reveal">
        <h4 style="margin:0 0 8px">私たちの姿勢</h4>
        <p style="color:var(--muted);margin:0 0 12px">
          的確な劣化診断、下地づくり、そして仕上げの美しさ。<br>
          塗装・外装のプロフェッショナルとして、誠実な施工をお約束します。
        </p>
        <ul style="margin:0 0 0 1.2em;color:var(--muted)">
          <li>丁寧な現地調査と明瞭なお見積り</li>
          <li>素材・色・工法の事前合意形成（図面・3Dイメージ対応）</li>
          <li>足場・近隣配慮・安全管理の徹底</li>
          <li>引渡し後の点検・アフターサポート</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- ====== BLOG (Recruit を置換) ====== -->
  <section id="blog" class="wrap">
    <div class="section-head">
      <div>
        <h3>ブログ</h3>
        <p>画像・タイトル・本文を投稿して、施工の思い出やお知らせをシェアしましょう。</p>
      </div>
      <span class="tag">Blog</span>
    </div>

    <div class="blog">
      <!-- 投稿フォーム -->
      <form id="postForm" class="post-form reveal" novalidate>
        <h4>新規投稿</h4>
        <div>
          <label for="postImage">画像（任意）</label>
          <input id="postImage" name="image" type="file" accept="image/*">
        </div>
        <div>
          <label for="postTitle">タイトル</label>
          <input id="postTitle" name="title" type="text" placeholder="タイトルを入力" required>
        </div>
        <div>
          <label for="postText">本文</label>
          <textarea id="postText" name="text" placeholder="本文を入力" required></textarea>
        </div>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn primary" type="submit">投稿する</button>
        </div>
        <p class="hint">※ 投稿はSupabaseに保存され、画像はStorage（バケット <b>post-images</b>）にアップロードされます。</p>
      </form>

      <!-- 投稿一覧 -->
      <div>
        <div class="post-list reveal" id="postList" aria-live="polite" aria-busy="false"></div>
        <div class="more">
          <button id="btnMore" class="btn ghost" type="button" hidden>もっと見る</button>
        </div>
      </div>
    </div>
  </section>

  <!-- ====== CONTACT ====== -->
  <section id="contact" class="wrap">
    <div class="section-head">
      <div>
        <h3>お問い合わせ</h3>
        <p>ご相談・お見積り・現調のご依頼など、下記よりお気軽にご連絡ください。</p>
      </div>
      <span class="tag">Contact</span>
    </div>

    <div class="about">
      <div class="panel reveal">
        <h4 style="margin:0 0 8px">電話・メール</h4>
        <p class="hint" style="margin:0 0 8px">※ ダミーです。正式な連絡先に差し替えてください。</p>
        <p>Tel：078-000-0000<br>Mail：info@example.jp</p>
        <a class="btn ghost" href="mailto:info@example.jp?subject=%E3%80%90%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B%E3%80%91%E3%82%B5%E3%82%A4%E3%83%88%E7%9B%B8%E8%AB%87">メールを送る</a>
      </div>
      <div class="panel reveal">
        <h4 style="margin:0 0 8px">対応エリア</h4>
        <p class="hint" style="margin:0 0 8px">兵庫・大阪を中心に関西一円。その他地域もご相談ください。</p>
        <p style="color:var(--muted)">現地調査からご提案・お見積りまで無料で対応いたします。</p>
      </div>
    </div>
  </section>

  <!-- ====== FOOTER ====== -->
  <footer>
    <div class="foot">
      <div class="mini">
        <img src="assets/ogura-logo.png" alt="ロゴ" style="width: 150px; height: auto;">
        <div>
          <span class="copyright">© <span id="y"></span> つながりリフォームバトン工房. All rights reserved.</span>
        </div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <a class="tag" href="#privacy">プライバシーポリシー</a>
        <a class="tag" href="#terms">特定商取引法に基づく表記</a>
      </div>
    </div>
  </footer>

  <!-- Supabase CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script>
    // ========================
    //  設定：Supabase 接続情報
    // ========================
    const SUPABASE_URL = 'https://iokuochhrkizhyvlwszv.supabase.co';     // ←差し替え
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlva3VvY2hocmtpemh5dmx3c3p2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAwNTIzMjksImV4cCI6MjA2NTYyODMyOX0.NjTLvYrMyAXEgMYhohtFh9b8sN8qpyOSxLk2RzLOUPA';                   // ←差し替え
    const BUCKET = 'post-images';                                // 画像バケット名（Public）
    const { createClient } = supabase;
    const sb = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // ===== Util: selector helpers =====
    const $ = (q, el=document) => el.querySelector(q);
    const $$ = (q, el=document) => [...el.querySelectorAll(q)];

    // ===== Mobile drawer toggle & auto-hide header =====
    const nav = document.getElementById('siteNav');
    const burger = document.getElementById('btnBurger');
    const mobile = document.getElementById('mobileMenu');
    const scrim = document.getElementById('scrim');

    function openMenu(){
      document.body.classList.add('menu-open');
      mobile.classList.add('open');
      mobile.removeAttribute('hidden');
      scrim.removeAttribute('hidden');
      burger.setAttribute('aria-expanded','true');
    }
    function closeMenu(){
      document.body.classList.remove('menu-open');
      mobile.classList.remove('open');
      scrim.setAttribute('hidden','');
      burger.setAttribute('aria-expanded','false');
      setTimeout(()=>mobile.setAttribute('hidden',''), 350);
    }
    burger.addEventListener('click', ()=>{
      if(mobile.classList.contains('open')) closeMenu(); else openMenu();
    });
    scrim.addEventListener('click', closeMenu);
    $$('#mobileMenu a').forEach(a=>a.addEventListener('click', closeMenu));
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && mobile.classList.contains('open')) closeMenu(); });

    // スクロール方向でヘッダーを隠す（モバイル幅のみ）
    let lastY = window.scrollY, ticking=false;
    function onScroll(){
      const y = window.scrollY;
      if(window.innerWidth <= 980 && !document.body.classList.contains('menu-open')){
        const goingDown = y > lastY;
        if(y > 80 && goingDown){ nav.classList.add('nav--hide'); }
        else { nav.classList.remove('nav--hide'); }
      }else{
        nav.classList.remove('nav--hide');
      }
      lastY = y; ticking=false;
    }
    window.addEventListener('scroll', ()=>{
      if(!ticking){ window.requestAnimationFrame(onScroll); ticking=true; }
    });

    // ===== Reveal on scroll =====
    const io = new IntersectionObserver(entries=>{
      entries.forEach(e=>{ if(e.isIntersecting) e.target.classList.add('show'); });
    },{threshold:.18});
    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

    // ===== Year in footer =====
    document.getElementById('y').textContent = new Date().getFullYear();

    // ===== Smooth scroll offset for sticky header =====
    document.querySelectorAll('a[href^="#"]').forEach(anchor=>{
      anchor.addEventListener('click', function(e){
        const id = this.getAttribute('href');
        if(id.length>1){
          const el = document.querySelector(id);
          if(el){
            e.preventDefault();
            const y = el.getBoundingClientRect().top + window.scrollY - 72;
            window.scrollTo({top:y, behavior:'smooth'});
          }
        }
      });
    });

    // ==========================
    //  Blog: Supabase CRUD
    // ==========================
    const PAGE_SIZE = 12;
    let lastRangeTo = PAGE_SIZE - 1;
    let loadedCount = 0;

    const postForm = document.getElementById('postForm');
    const postList = document.getElementById('postList');
    const btnMore = document.getElementById('btnMore');

    function escapeHTML(str){
      return (str || '').replace(/[&<>"']/g, s=>({
        '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
      })[s]);
    }
    const newID = () => (crypto && crypto.randomUUID) ? crypto.randomUUID() : ('id-' + Date.now() + '-' + Math.random().toString(16).slice(2));

    async function uploadImageToStorage(file){
      if(!file) return null; // 画像なし
      const ext = (file.name.split('.').pop() || 'jpg').toLowerCase();
      const path = `blog/${newID()}.${ext}`;
      const { data, error } = await sb.storage.from(BUCKET).upload(path, file, {
        cacheControl: '3600',
        upsert: false,
        contentType: file.type || 'image/jpeg'
      });
      if(error){ throw error; }
      const { data:pub } = sb.storage.from(BUCKET).getPublicUrl(path);
      return pub.publicUrl || null;
    }

    async function insertPost({title, body, imageUrl}){
      const { data, error } = await sb
        .from('blog_posts')
        .insert({ title, body, image_url: imageUrl })
        .select()
        .single();
      if(error){ throw error; }
      return data;
    }

    function cardHTML(p){
      const img = p.image_url ? `<img src="${p.image_url}" alt="${escapeHTML(p.title)}">` : `<span class="hint" style="padding:10px">No Image</span>`;
      const dt = new Date(p.created_at);
      const y = dt.getFullYear(), m = String(dt.getMonth()+1).padStart(2,'0'), d = String(dt.getDate()).padStart(2,'0');
      const hh = String(dt.getHours()).padStart(2,'0'), mm = String(dt.getMinutes()).padStart(2,'0');
      return `
        <article class="post">
          <div class="ph">${img}</div>
          <div class="body">
            <h5 class="title">${escapeHTML(p.title)}</h5>
            <p class="text">${escapeHTML(p.body || '')}</p>
            <div class="meta">投稿日時：${y}/${m}/${d} ${hh}:${mm}</div>
          </div>
        </article>
      `;
    }

    async function fetchAndRenderPosts({append=false}={}){
      postList.setAttribute('aria-busy','true');

      // 既にロードした件数を考慮して range を指定
      const from = append ? loadedCount : 0;
      const to   = from + PAGE_SIZE - 1;
      const { data, error, count } = await sb
        .from('blog_posts')
        .select('*', { count: 'exact' })
        .order('created_at', { ascending:false })
        .range(from, to);

      if(error){
        console.error(error);
        postList.innerHTML = `<p class="hint">投稿の取得に失敗しました。設定（URLとAnonキー）をご確認ください。</p>`;
        btnMore.hidden = true;
        postList.setAttribute('aria-busy','false');
        return;
      }

      if(!append){ postList.innerHTML=''; loadedCount = 0; }
      const frag = document.createDocumentFragment();
      (data || []).forEach(p=>{
        const div = document.createElement('div');
        div.innerHTML = cardHTML(p);
        frag.appendChild(div.firstElementChild);
      });
      postList.appendChild(frag);

      loadedCount += (data || []).length;
      // もっと見る判定
      btnMore.hidden = !(count && loadedCount < count);

      postList.setAttribute('aria-busy','false');
    }

    postForm.addEventListener('submit', async (ev)=>{
      ev.preventDefault();
      const title = (postForm.title.value || '').trim();
      const body  = (postForm.text.value  || '').trim();
      const file  = postForm.image.files[0];

      if(!title || !body){
        alert('タイトルと本文は必須です。');
        return;
      }
      try{
        const imageUrl = await uploadImageToStorage(file); // 画像なしなら null
        await insertPost({ title, body, imageUrl });
        postForm.reset();
        alert('投稿しました。');
        // 先頭に反映したいので再取得
        await fetchAndRenderPosts({ append:false });
      }catch(err){
        console.error(err);
        alert('投稿に失敗しました。権限・Storage設定・ネットワークをご確認ください。');
      }
    });

    btnMore.addEventListener('click', ()=> fetchAndRenderPosts({ append:true }));

    // 初期ロード
    fetchAndRenderPosts({ append:false });
  </script>
</body>
</html>
