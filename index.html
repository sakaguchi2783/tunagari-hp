<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#070b0f" />
  <title>つながりリフォームバトン工房</title>
  <meta name="description" content="つながりリフォームバトン工房｜建築塗装・仮設足場・手形思い出外壁工事・タイムカプセル外壁工事・外装リフォーム全般" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 rx=%2218%22 fill=%22%23060a0f%22/><text x=%2250%22 y=%2270%22 font-size=%2270%22 text-anchor=%22middle%22 fill=%22%23fff%22>TB</text></svg>">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800;900&family=Noto+Sans+JP:wght@300;400;500;700;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg0:#040608;
      --bg1:#070b0f;
      --panel:rgba(255,255,255,.045);
      --panel2:rgba(255,255,255,.03);
      --ink:#eafff6;
      --muted:#9fb1aa;
      --accent:#22f3a6;     /* neon mint */
      --accent2:#2dd4ff;    /* neon cyan */
      --warm:#ffb86b;       /* warm */
      --hot:#ff4d6d;        /* pink */
      --line:rgba(255,255,255,.10);
      --line2:rgba(255,255,255,.06);
      --shadow: 0 18px 55px rgba(0,0,0,.55);
      --shadow2: 0 10px 25px rgba(0,0,0,.35);
      --radius:18px;
      --radius2:22px;
      --max:1200px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--ink);
      font-family:"Noto Sans JP","Outfit",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue","Hiragino Kaku Gothic ProN","Hiragino Sans",Meiryo,sans-serif;
      background:
        radial-gradient(1100px 600px at 80% -20%, rgba(34,243,166,.13), transparent 55%),
        radial-gradient(900px 500px at 10% 110%, rgba(45,212,255,.10), transparent 60%),
        radial-gradient(700px 450px at 65% 80%, rgba(255,184,107,.07), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
      scroll-behavior:smooth;
    }

    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}
    button{font:inherit}
    ::selection{background:rgba(34,243,166,.25)}

    /* ====== Animated background orbs ====== */
    .bg-orbs{
      position:fixed; inset:-20vh -20vw; z-index:-5; pointer-events:none;
      filter: saturate(1.2);
    }
    .orb{
      position:absolute; border-radius:50%;
      filter: blur(90px);
      opacity:.18;
      mix-blend-mode: screen;
      transform: translate3d(0,0,0);
    }
    .orb-a{ width:680px; height:680px; left:5%; top:0%; background: radial-gradient(circle at 30% 30%, var(--accent), transparent 55%); animation: orbA 16s ease-in-out infinite; }
    .orb-b{ width:720px; height:720px; right:8%; top:10%; background: radial-gradient(circle at 30% 30%, var(--accent2), transparent 55%); animation: orbB 20s ease-in-out infinite; }
    .orb-c{ width:700px; height:700px; left:30%; bottom:-5%; background: radial-gradient(circle at 30% 30%, var(--warm), transparent 60%); animation: orbC 22s ease-in-out infinite; }

    @keyframes orbA{
      0%,100%{ transform: translate3d(0,0,0) scale(1); }
      50%{ transform: translate3d(12vw, 6vh, 0) scale(1.08); }
    }
    @keyframes orbB{
      0%,100%{ transform: translate3d(0,0,0) scale(1.02); }
      50%{ transform: translate3d(-10vw, 10vh, 0) scale(1.12); }
    }
    @keyframes orbC{
      0%,100%{ transform: translate3d(0,0,0) scale(1); }
      50%{ transform: translate3d(8vw, -8vh, 0) scale(1.10); }
    }

    /* ====== Noise overlay ====== */
    .noise{
      position:fixed; inset:0; z-index:-4; pointer-events:none;
      background-image:
        radial-gradient(rgba(255,255,255,.035) 1px, transparent 1px),
        radial-gradient(rgba(255,255,255,.02) 1px, transparent 1px);
      background-size: 36px 36px, 72px 72px;
      background-position: 0 0, 18px 18px;
      opacity:.35;
      mix-blend-mode: overlay;
      mask-image: radial-gradient(circle at 50% 30%, rgba(0,0,0,.9), rgba(0,0,0,.25) 55%, rgba(0,0,0,0) 85%);
    }

    /* ====== Scroll progress ====== */
    .progress{
      position:fixed; top:0; left:0; right:0; height:3px; z-index:120;
      background: rgba(255,255,255,.04);
      backdrop-filter: blur(6px);
    }
    .progress span{
      display:block; height:100%; width:0%;
      background: linear-gradient(90deg, var(--accent), var(--accent2), var(--warm));
      box-shadow: 0 0 18px rgba(34,243,166,.35);
      border-radius:999px;
      transition: width .08s linear;
    }

    /* ====== Cursor glow (desktop) ====== */
    .cursor-glow{
      position:fixed; left:0; top:0; z-index:0; pointer-events:none;
      width:520px; height:520px;
      transform: translate(-50%,-50%);
      border-radius:50%;
      background: radial-gradient(circle at 35% 35%, rgba(34,243,166,.16), transparent 55%),
                  radial-gradient(circle at 65% 55%, rgba(45,212,255,.12), transparent 55%),
                  radial-gradient(circle at 50% 75%, rgba(255,184,107,.08), transparent 60%);
      filter: blur(10px);
      opacity:.0;
      transition: opacity .25s ease;
      mix-blend-mode: screen;
    }

    /* ====== Layout helpers ====== */
    section{scroll-margin-top:90px}
    .wrap{max-width:var(--max);margin:auto;padding:90px 20px}
    .section-head{
      display:flex;justify-content:space-between;align-items:flex-end;gap:18px;margin-bottom:26px
    }
    .section-head h3{
      margin:0;
      font:900 clamp(22px, 2.2vw, 30px)/1 "Outfit";
      letter-spacing:.7px;
    }
    .section-head p{margin:10px 0 0;color:var(--muted)}
    .tag{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 12px;border-radius:999px;
      border:1px solid var(--line2);
      background: linear-gradient(180deg, rgba(255,255,255,.045), rgba(255,255,255,.015));
      color:rgba(234,255,246,.86);
      font:700 12px/1 "Outfit";
      letter-spacing:.6px;
      box-shadow: 0 10px 25px rgba(0,0,0,.25);
      white-space:nowrap;
    }
    .tag::before{
      content:"";
      width:8px;height:8px;border-radius:50%;
      background: linear-gradient(180deg, var(--accent), var(--accent2));
      box-shadow: 0 0 14px rgba(34,243,166,.35);
      display:inline-block;
    }

    /* ====== NAV ====== */
    .nav{
      position:sticky; top:0; z-index:100;
      background: rgba(6,9,12,.52);
      border-bottom:1px solid rgba(255,255,255,.06);
      backdrop-filter: blur(12px);
      box-shadow: 0 10px 40px rgba(0,0,0,.35);
      transition: transform .35s ease;
      will-change: transform;
    }
    .nav::after{
      content:""; position:absolute; left:0; right:0; bottom:-1px; height:2px;
      background: linear-gradient(90deg, transparent, rgba(34,243,166,.55), rgba(45,212,255,.45), transparent);
      opacity:.75;
      filter: blur(.2px);
      pointer-events:none;
    }
    .nav.nav--hide{transform: translateY(-110%)}
    .nav-inner{
      max-width:var(--max); margin:auto;
      display:flex; align-items:center; gap:16px;
      padding:12px 18px;
    }
    .brand{display:flex; align-items:center; gap:12px}
    .brand img{
      width:44px;height:44px;object-fit:contain;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.35));
    }

    .menu{margin-left:auto;display:flex;gap:8px;align-items:center}
    .menu a{
      padding:10px 14px;border-radius:999px;
      border:1px solid transparent;
      font:800 13px/1 "Outfit";
      letter-spacing:.6px;
      color:rgba(234,255,246,.90);
      position:relative;
      transition: transform .2s ease, background .2s ease, border-color .2s ease;
      opacity:.95;
    }
    .menu a:hover{
      transform: translateY(-1px);
      border-color: rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      opacity:1;
    }
    .menu a::after{
      content:""; position:absolute; left:14px; right:14px; bottom:7px; height:2px; border-radius:2px;
      background: linear-gradient(90deg, transparent, var(--accent), var(--accent2), transparent);
      transform: scaleX(0);
      transform-origin:left;
      transition: transform .35s ease;
      opacity:.9;
    }
    .menu a:hover::after{transform: scaleX(1)}
    .cta{
      background: linear-gradient(135deg, var(--accent), #19c88d);
      color:#03110a !important;
      border-color: transparent !important;
      box-shadow: 0 10px 28px rgba(34,243,166,.25);
    }

    .burger{display:none;margin-left:8px}
    .burger button{
      background: rgba(255,255,255,.02);
      border:1px solid rgba(255,255,255,.10);
      border-radius:14px;
      padding:10px 12px;
      color:var(--ink);
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
      transition: transform .2s ease, border-color .2s ease;
    }
    .burger button:hover{transform: translateY(-1px); border-color: rgba(255,255,255,.18)}

    /* ===== Mobile drawer ===== */
    @media (max-width:980px){
      .menu{display:none}
      .burger{display:block}

      .menu-mobile{
        position:fixed; inset:0 auto 0 0;
        width:min(82%, 340px);
        display:block;
        padding:18px;
        border-right:1px solid rgba(255,255,255,.08);
        background: rgba(6,9,12,.98);
        transform: translateX(-105%);
        transition: transform .35s ease;
        z-index:140;
        overflow:auto;
      }
      .menu-mobile.open{transform: translateX(0)}
      .menu-mobile .drawer-top{
        display:flex; align-items:center; justify-content:space-between;
        margin-bottom:10px;
      }
      .menu-mobile .drawer-title{
        font:900 14px/1 "Outfit"; letter-spacing:1.4px; color:rgba(234,255,246,.92);
      }
      .menu-mobile a{
        display:block;
        padding:14px 14px;
        border:1px solid rgba(255,255,255,.10);
        border-radius:14px;
        margin-bottom:10px;
        background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
        box-shadow: 0 12px 30px rgba(0,0,0,.35);
        font-weight:800;
      }
      .menu-mobile a.cta{border-color:transparent}
      .scrim{
        position:fixed; inset:0;
        background: rgba(0,0,0,.40);
        backdrop-filter: blur(2px);
        z-index:130;
      }
      .scrim[hidden]{display:none}
      body.menu-open{overflow:hidden}
    }

    /* ====== HERO ====== */
    .hero{
      position:relative;
      overflow:hidden;
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .hero-fx{
      position:absolute; inset:0;
      width:100%; height:100%;
      z-index:0;
      opacity:.85;
      pointer-events:none;
    }
    .hero::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(900px 500px at 15% 20%, rgba(34,243,166,.10), transparent 55%),
        radial-gradient(900px 500px at 85% 10%, rgba(45,212,255,.08), transparent 55%),
        radial-gradient(700px 450px at 70% 85%, rgba(255,184,107,.06), transparent 60%);
      z-index:0;
      pointer-events:none;
      filter: blur(0px);
      opacity:.95;
    }
    .hero-inner{
      max-width:var(--max);
      margin:auto;
      padding:94px 20px 92px;
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:26px;
      align-items:center;
      position:relative;
      z-index:1;
    }
    @media (max-width:980px){
      .hero-inner{grid-template-columns:1fr; padding:64px 20px 72px}
    }

    .pill{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      margin-bottom:16px;
    }
    .pill b{
      background: linear-gradient(90deg, var(--accent), var(--accent2), var(--warm));
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
      font:900 13px/1 "Outfit";
      letter-spacing:1px;
    }

    .hero h2{
      margin:0 0 14px;
      font: 900 clamp(30px, 4.1vw, 50px)/1.08 "Outfit";
      letter-spacing:.4px;
    }
    .hero h2 .grad{
      background: linear-gradient(90deg, rgba(234,255,246,.98), rgba(34,243,166,.95), rgba(45,212,255,.8));
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
    }
    .hero p{
      margin:0 0 24px;
      color: rgba(159,177,170,.95);
      font-size: 16px;
      line-height:1.8;
    }

    .hero-cta{display:flex; gap:12px; flex-wrap:wrap; align-items:center}

    .btn{
      position:relative;
      padding:14px 18px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.035), rgba(255,255,255,.01));
      color: rgba(234,255,246,.95);
      font-weight:900;
      letter-spacing:.2px;
      box-shadow: var(--shadow2);
      overflow:hidden;
      transition: transform .18s ease, border-color .2s ease, box-shadow .2s ease, filter .2s ease;
      will-change: transform;
    }
    .btn:hover{
      transform: translateY(-2px);
      border-color: rgba(255,255,255,.18);
      box-shadow: 0 20px 55px rgba(0,0,0,.55);
      filter: brightness(1.02);
    }
    .btn:active{transform: translateY(0px) scale(.99)}
    .btn::before{
      content:"";
      position:absolute;
      top:-50%;
      left:-35%;
      width:35%;
      height:200%;
      background: rgba(255,255,255,.22);
      transform: rotate(25deg) translateX(-220%);
      transition: transform .7s ease;
      opacity:.55;
    }
    .btn:hover::before{
      transform: rotate(25deg) translateX(520%);
    }

    .btn.primary{
      background: linear-gradient(135deg, var(--accent), #19c88d);
      color:#03110a;
      border-color: transparent;
      box-shadow: 0 18px 45px rgba(34,243,166,.20);
    }
    .btn.ghost:hover{border-color: rgba(255,255,255,.22)}

    .btn.icon{
      display:inline-flex; align-items:center; gap:10px;
      font-weight:900;
    }
    .btn.icon svg{width:20px;height:20px;flex:0 0 auto}
    .btn.app{
      background: linear-gradient(135deg, var(--accent), #15d3ff);
      color:#041018;
      border-color: transparent;
      box-shadow: 0 18px 50px rgba(45,212,255,.20);
    }
    .btn.yt{
      background: linear-gradient(135deg, #ff3b3b, #d51643);
      color:#fff;
      border-color: transparent;
      box-shadow: 0 18px 50px rgba(255,59,59,.18);
    }

    /* ====== KPI panel ====== */
    .kside{
      border-radius: var(--radius2);
      border:1px solid rgba(255,255,255,.09);
      background: linear-gradient(180deg, rgba(255,255,255,.045), rgba(255,255,255,.02));
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      padding:16px;
      position:relative;
      overflow:hidden;
    }
    .kside::before{
      content:"";
      position:absolute; inset:-2px;
      background: radial-gradient(800px 300px at 20% 0%, rgba(34,243,166,.13), transparent 60%),
                  radial-gradient(800px 300px at 90% 30%, rgba(45,212,255,.10), transparent 60%);
      opacity:.8;
      pointer-events:none;
    }
    .grid-kpis{
      display:grid;
      grid-template-columns:repeat(2, 1fr);
      gap:12px;
      position:relative;
      z-index:1;
    }
    .kpi{
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(5,10,12,.22);
      backdrop-filter: blur(12px);
      padding:18px;
      box-shadow: 0 14px 32px rgba(0,0,0,.35);
      position:relative;
      overflow:hidden;
    }
    .kpi::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(320px circle at var(--mx,50%) var(--my,50%), rgba(34,243,166,.20), transparent 55%);
      opacity:0;
      transition: opacity .25s ease;
      pointer-events:none;
    }
    .kpi:hover::after{opacity:1}
    .kpi h3{
      margin:0;
      font: 900 30px/1 "Outfit";
      letter-spacing:.4px;
    }
    .kpi p{
      margin:8px 0 0;
      color: rgba(159,177,170,.92);
      font-size:12px;
      line-height:1.4;
    }

    /* ====== GRID CARDS ====== */
    .grid{display:grid; gap:18px}
    .grid.cards{grid-template-columns:repeat(3, 1fr)}
    @media (max-width:980px){ .grid.cards{grid-template-columns:1fr} }

    .card{
      position:relative;
      border-radius: var(--radius2);
      border:1px solid rgba(255,255,255,.09);
      background: linear-gradient(180deg, rgba(255,255,255,.045), rgba(255,255,255,.02));
      box-shadow: var(--shadow2);
      overflow:hidden;
      transform: perspective(950px) rotateX(var(--rx,0deg)) rotateY(var(--ry,0deg)) translateY(var(--ty,0px));
      transition: transform .25s ease, border-color .25s ease, box-shadow .25s ease;
      will-change: transform;
      backdrop-filter: blur(14px);
    }
    .card.tilt:hover{--ty:-4px; box-shadow: 0 20px 60px rgba(0,0,0,.55); border-color: rgba(255,255,255,.18);}

    /* gradient border glow */
    .card::before{
      content:"";
      position:absolute; inset:0;
      padding:1px;
      border-radius: inherit;
      background: linear-gradient(135deg,
        rgba(34,243,166,.55),
        rgba(45,212,255,.35),
        rgba(255,184,107,.20),
        rgba(255,77,109,.18)
      );
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
              mask-composite: exclude;
      opacity:.35;
      transition: opacity .25s ease;
      pointer-events:none;
    }
    .card:hover::before{opacity:.95}

    /* moving highlight */
    .card::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(520px circle at var(--mx,50%) var(--my,50%), rgba(34,243,166,.16), transparent 60%);
      opacity:0;
      transition: opacity .25s ease;
      pointer-events:none;
    }
    .card:hover::after{opacity:1}

.thumb{
  height:190px;
  position:relative;
  overflow:hidden;
  border-bottom: 1px solid rgba(255,255,255,.08);

  /* ここが画像 */
  background: center / cover no-repeat var(--thumb, none);
}

/* いまの“雰囲気のあるグラデーション”は上に重ねる */
.thumb::after{
  content:"";
  position:absolute;
  inset:0;
  background:
    radial-gradient(700px 140px at 20% 120%, rgba(34,243,166,.18), transparent 60%),
    radial-gradient(620px 140px at 80% 120%, rgba(45,212,255,.12), transparent 60%),
    linear-gradient(135deg, rgba(255,184,107,.14), rgba(255,184,107,0) 40%),
    linear-gradient(180deg, rgba(0,0,0,.0), rgba(0,0,0,.35));
  opacity:.9;
  pointer-events:none;
}

    .card .body{padding:18px}
    .card h4{
      margin:0 0 10px;
      font: 900 18px/1.25 "Noto Sans JP";
      letter-spacing:.2px;
    }
    .card p{
      margin:0;
      color: rgba(159,177,170,.95);
      font-size:14px;
      line-height:1.7;
    }

    /* ====== ABOUT ====== */
    .about{
      display:grid; grid-template-columns:1.05fr .95fr; gap:18px;
    }
    @media (max-width:980px){ .about{grid-template-columns:1fr} }

    .panel{
      border-radius: var(--radius2);
      border:1px solid rgba(255,255,255,.09);
      background: linear-gradient(180deg, rgba(255,255,255,.045), rgba(255,255,255,.02));
      box-shadow: var(--shadow2);
      backdrop-filter: blur(14px);
      padding:22px;
      position:relative;
      overflow:hidden;
    }
    .panel::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(650px circle at 20% 0%, rgba(34,243,166,.12), transparent 65%),
                  radial-gradient(650px circle at 90% 20%, rgba(45,212,255,.10), transparent 65%);
      opacity:.75;
      pointer-events:none;
    }
    .panel > *{position:relative; z-index:1}

    .kv{
      border-radius:16px;
      border:1px dashed rgba(255,255,255,.16);
      background: rgba(255,255,255,.02);
      padding:14px;
      display:flex; gap:14px; align-items:center;
    }
    .data{display:grid; grid-template-columns:repeat(2,1fr); gap:12px; margin-top:14px}
    .item{
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(5,10,12,.20);
      padding:12px;
    }
    .item b{display:block; font:900 14px/1 "Outfit"; letter-spacing:.8px}
    .item small{display:block; margin-top:6px; color:rgba(159,177,170,.95)}

    /* ====== BLOG ====== */
    .blog{
      display:grid; grid-template-columns:1fr 1fr; gap:18px;
    }
    @media (max-width:980px){ .blog{grid-template-columns:1fr} }

    .post-form h4{margin:0 0 10px; font-weight:900}
    label{display:block; font-weight:800; margin-bottom:8px; font-size:13px; color:rgba(234,255,246,.9)}
    input[type="text"], textarea{
      width:100%;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(3,6,8,.55);
      color: var(--ink);
      outline:none;
      transition: border-color .2s ease, box-shadow .2s ease;
    }
    input[type="text"]:focus, textarea:focus{
      border-color: rgba(34,243,166,.45);
      box-shadow: 0 0 0 4px rgba(34,243,166,.10);
    }
    textarea{min-height:140px; resize:vertical; line-height:1.7}

    .dropzone{
      border-radius:16px;
      border:1px dashed rgba(255,255,255,.22);
      background: rgba(255,255,255,.02);
      padding:14px;
      display:flex;
      align-items:center;
      gap:12px;
      cursor:pointer;
      transition: border-color .2s ease, background .2s ease, transform .2s ease;
    }
    .dropzone:hover{
      border-color: rgba(45,212,255,.45);
      background: rgba(255,255,255,.03);
      transform: translateY(-1px);
    }
    .dz-icon{
      width:44px; height:44px; border-radius:14px;
      display:grid; place-items:center;
      background: linear-gradient(135deg, rgba(34,243,166,.18), rgba(45,212,255,.12));
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 14px 28px rgba(0,0,0,.35);
      flex:0 0 auto;
    }
    .dz-icon svg{width:22px; height:22px}
    .dz-text b{display:block; font-weight:900}
    .dz-text small{display:block; margin-top:4px; color:rgba(159,177,170,.95)}
    .dz-preview{
      margin-left:auto;
      width:78px; height:54px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
      background: rgba(0,0,0,.25);
      flex:0 0 auto;
      display:grid; place-items:center;
    }
    .dz-preview img{width:100%; height:100%; object-fit:cover}
    .dz-preview .hint{font-size:12px; color:rgba(159,177,170,.95)}
    .hidden-input{display:none}

    .hint{color:rgba(159,177,170,.95); font-size:12px; line-height:1.6; margin-top:10px}

    .post-list{display:grid; grid-template-columns:repeat(2, 1fr); gap:16px}
    @media (max-width:980px){ .post-list{grid-template-columns:1fr} }

    .post{
      border-radius: var(--radius2);
      border:1px solid rgba(255,255,255,.09);
      background: linear-gradient(180deg, rgba(255,255,255,.045), rgba(255,255,255,.02));
      box-shadow: var(--shadow2);
      overflow:hidden;
      backdrop-filter: blur(14px);
      position:relative;
      transform: perspective(950px) rotateX(var(--rx,0deg)) rotateY(var(--ry,0deg));
      transition: transform .25s ease, border-color .25s ease, box-shadow .25s ease;
      will-change: transform;
    }
    .post.tilt:hover{border-color: rgba(255,255,255,.18); box-shadow: 0 20px 60px rgba(0,0,0,.55)}
    .post::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(520px circle at var(--mx,50%) var(--my,50%), rgba(45,212,255,.14), transparent 60%);
      opacity:0;
      transition: opacity .25s ease;
      pointer-events:none;
    }
    .post:hover::after{opacity:1}

    .post .ph{height:190px; background: rgba(0,0,0,.25); display:flex; align-items:center; justify-content:center}
    .post .ph img{width:100%; height:100%; object-fit:cover}
    .post .body{padding:14px}
    .post .title{margin:0 0 8px; font:900 16px/1.25 "Noto Sans JP"}
    .post .text{margin:0 0 10px; color:rgba(159,177,170,.95); font-size:14px; line-height:1.7; white-space:pre-wrap}
    .post .meta{color:rgba(159,177,170,.9); font-size:12px}

    .skeleton{
      position:relative;
      overflow:hidden;
    }
    .skeleton .ph, .skeleton .title, .skeleton .text, .skeleton .meta{
      background: rgba(255,255,255,.05);
      color: transparent;
      border-radius: 12px;
    }
    .skeleton .title{height:18px; width:72%; margin:0 0 10px}
    .skeleton .text{height:52px; width:100%; margin:0 0 10px}
    .skeleton .meta{height:12px; width:40%}
    .skeleton::before{
      content:"";
      position:absolute; top:-30%; left:-40%;
      width:40%; height:160%;
      background: rgba(255,255,255,.10);
      transform: rotate(25deg);
      animation: shimmer 1.2s linear infinite;
      opacity:.35;
    }
    @keyframes shimmer{
      0%{transform: rotate(25deg) translateX(-220%)}
      100%{transform: rotate(25deg) translateX(520%)}
    }

    .more{margin-top:14px; display:flex}
    .more .btn{margin:auto}

    /* ====== CONTACT ====== */
    .contact-grid{
      display:grid; grid-template-columns:1fr 1fr; gap:18px;
    }
    @media (max-width:980px){ .contact-grid{grid-template-columns:1fr} }

    /* ====== FOOTER ====== */
    footer{
      border-top:1px solid rgba(255,255,255,.06);
      padding:28px 20px;
      color: rgba(159,177,170,.95);
      background: linear-gradient(180deg, rgba(255,255,255,.02), transparent);
    }
    .foot{
      max-width:var(--max); margin:auto;
      display:flex; gap:18px; align-items:center; justify-content:space-between; flex-wrap:wrap;
    }
    .foot .mini{display:flex; gap:12px; align-items:center}
    .foot img{width:36px; height:36px}
    .copyright{font-size:12px}

    /* ====== Reveal animation ====== */
    .reveal{
      opacity:0;
      transform: translateY(18px) scale(.985);
      filter: blur(5px);
      transition: opacity .8s cubic-bezier(.2,.7,.2,1),
                  transform .8s cubic-bezier(.2,.7,.2,1),
                  filter .8s cubic-bezier(.2,.7,.2,1);
    }
    .reveal.show{
      opacity:1;
      transform:none;
      filter: blur(0);
    }

    /* ====== Toast ====== */
    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform: translateX(-50%) translateY(20px);
      background: rgba(6,9,12,.85);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 999px;
      padding:12px 14px;
      box-shadow: 0 18px 55px rgba(0,0,0,.55);
      backdrop-filter: blur(12px);
      color: rgba(234,255,246,.95);
      font-weight:900;
      letter-spacing:.2px;
      opacity:0;
      pointer-events:none;
      transition: opacity .25s ease, transform .25s ease;
      z-index:200;
      max-width:min(92vw, 520px);
      text-align:center;
    }
    .toast.show{opacity:1; transform: translateX(-50%) translateY(0)}
    .toast[data-type="error"]{border-color: rgba(255,77,109,.35)}
    .toast[data-type="ok"]{border-color: rgba(34,243,166,.35)}

    /* ====== Reduced motion ====== */
    @media (prefers-reduced-motion: reduce){
      *{scroll-behavior:auto !important}
      .orb{animation:none !important}
      .btn::before{transition:none}
      .reveal{transition:none; opacity:1; transform:none; filter:none}
      .hero-fx{display:none}
      .cursor-glow{display:none}
      .progress span{transition:none}
    }
  </style>
</head>

<body>
  <!-- Background -->
  <div class="bg-orbs" aria-hidden="true">
    <div class="orb orb-a"></div>
    <div class="orb orb-b"></div>
    <div class="orb orb-c"></div>
  </div>
  <div class="noise" aria-hidden="true"></div>

  <!-- UI FX -->
  <div class="progress" aria-hidden="true"><span id="progressBar"></span></div>
  <div id="cursorGlow" class="cursor-glow" aria-hidden="true"></div>
  <div id="toast" class="toast" aria-live="polite" aria-atomic="true"></div>

  <!-- ====== NAV ====== -->
  <header class="nav" id="siteNav">
    <div class="nav-inner">
      <a class="brand" href="#home" aria-label="つながりリフォームバトン工房">
        <img src="assets/ogura-logo.png" alt="ロゴ" style="width: 200px; height: auto;">
      </a>

      <nav class="menu" aria-label="主なメニュー">
        <a href="#home">ホーム</a>
        <a href="#services">事業内容</a>
        <a href="#about">会社概要</a>
        <a href="#blog">ブログ</a>
        <a class="cta" href="#contact">お問い合わせ</a>
      </nav>

      <div class="burger">
        <button id="btnBurger" aria-expanded="false" aria-controls="mobileMenu" aria-label="メニュー">≡</button>
      </div>
    </div>

    <!-- 左ドロワー -->
    <nav id="mobileMenu" class="menu-mobile" aria-label="モバイルメニュー" hidden>
      <div class="drawer-top">
        <div class="drawer-title">MENU</div>
        <button id="btnCloseDrawer" class="btn" type="button" style="padding:10px 12px;border-radius:14px">×</button>
      </div>
      <a href="#home">ホーム</a>
      <a href="#services">事業内容</a>
      <a href="#about">会社概要</a>
      <a href="#blog">ブログ</a>
      <a class="cta" href="#contact">お問い合わせ</a>
      <p class="hint">スクロールでヘッダーは自動で隠れます。必要なときに≡から開いてください。</p>
    </nav>
    <div id="scrim" class="scrim" hidden></div>
  </header>

  <!-- ====== HERO ====== -->
  <section id="home" class="hero">
    <canvas id="fx" class="hero-fx" aria-hidden="true"></canvas>

    <div class="hero-inner">
      <div class="copy reveal">
        <div class="pill">
          <span class="tag">AURORA BUILD</span>
          <b>TSUNAGARI REFORM</b>
        </div>

        <h2><span class="grad">‟家族のための壁作り…”</span><br>大切な人と地域を繋ぐ。</h2>

        <p>
          建築塗装・仮設足場・手形思い出外壁工事<br>タイムカプセル外壁工事・外装リフォーム全般まで。<br>
          <br>“見た目の美しさ”と“耐久の本質”を両立する施工で、<br>住まいの価値を未来へつなぎます。
        </p>

        <div class="hero-cta">
          <a class="btn primary" href="#services">事業内容を見る</a>

          <a class="btn icon app" href="https://tunagari-reform.netlify.app/" target="_blank" rel="noopener" aria-label="アプリへ">
            <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <path d="M12 3l8 6v10a2 2 0 0 1-2 2h-3v-6H9v6H6a2 2 0 0 1-2-2V9l8-6z" fill="currentColor" opacity=".95"/>
              <path d="M13 11h5M16 8l3 3-3 3" stroke="#052b1f" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            無料見積りアプリへ
          </a>

          <a class="btn ghost" href="#blog">ブログを見る</a>
        </div>
      </div>

      <aside class="kside reveal" aria-label="実績概況">
        <div class="grid-kpis">
          <div class="kpi tilt" data-tilt>
            <h3 data-count="300" data-suffix="+">0</h3>
            <p>累計施工案件</p>
          </div>
          <div class="kpi tilt" data-tilt>
            <h3 data-count="98" data-suffix="%">0</h3>
            <p>お客様満足度（自社アンケート）</p>
          </div>
          <div class="kpi tilt" data-tilt>
            <h3 data-count="20" data-suffix="年">0</h3>
            <p>外装・塗装の専門キャリア</p>
          </div>
          <div class="kpi tilt" data-tilt>
            <h3>0→1</h3>
            <p>調査から施工まで一貫体制</p>
          </div>
        </div>
      </aside>
    </div>
  </section>

  <!-- ====== SERVICES ====== -->
  <section id="services" class="wrap">
    <div class="section-head">
      <div>
        <h3>事業内容</h3>
        <p>多様な要件に合わせ、調査・設計・施工・アフターまでワンストップで対応します。</p>
      </div>
      <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap">
        <a class="btn icon yt" href="https://youtube.com/@profuu2024?si=9G7Eu1DOY_BqP4Oc" target="_blank" rel="noopener" aria-label="YouTubeで動画を見る">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <rect x="3" y="5" width="18" height="14" rx="3" fill="currentColor" opacity=".95"></rect>
            <polygon points="10,9 16,12 10,15" fill="#fff"></polygon>
          </svg>
          動画で見る
        </a>
        <span class="tag">SERVICES</span>
      </div>
    </div>


    
    <div class="grid cards">
      <article class="card tilt reveal" data-tilt>
        <div class="thumb"
     style="--thumb:url('assets/services/tosou.jpg');"
     role="img"
     aria-label="建築塗装の写真"></div>
        <div class="body">
          <h4>建築塗装</h4>
          <p>外壁・屋根・付帯部の塗装。劣化診断から下地補修、塗料選定・施工まで一貫対応。美観と耐久性を両立します。</p>
        </div>
      </article>

      <article class="card tilt reveal" data-tilt>
        <div class="thumb" style="--thumb:url('assets/services/ashiba.jpg');" role="img" aria-label="仮設足場の写真"></div>
        <div class="body">
          <h4>仮設足場</h4>
          <p>安全第一の足場を手配。近隣配慮・飛散防止・動線計画を徹底し、品質と安全を確保します。</p>
        </div>
      </article>

      <article class="card tilt reveal" data-tilt>
        <div class="thumb" style="--thumb:url('assets/services/tegatamemory.jpg');" role="img" aria-label="手形思い出外壁工事の写真"></div>
        <div class="body">
          <h4>手形思い出外壁工事</h4>
          <p>ご家族の手形を外壁に残すメモリアル施工。耐候性に配慮し、思い出を美しく長く残します。</p>
        </div>
      </article>

      <article class="card tilt reveal" data-tilt>
        <div class="thumb" style="--thumb:url('assets/services/timecapsule.jpg');" role="img" aria-label="タイムカプセル外壁工事の写真"></div>
        <div class="body">
          <h4>タイムカプセル外壁工事</h4>
          <p>外壁に専用ボックスやプレートを設置。防水・安全性・将来の開封計画まで設計し、物語を未来へ。</p>
        </div>
      </article>

      <article class="card tilt reveal" data-tilt>
        <div class="thumb" style="--thumb:url('assets/services/reform.jpg');" role="img" aria-label="外装リフォーム全般の写真"></div>
        <div class="body">
          <h4>外装リフォーム全般</h4>
          <p>サイディング、シーリング、雨樋、屋根改修など外装をトータルでメンテナンス。費用対効果を最適化します。</p>
        </div>
      </article>

      <article class="card tilt reveal" data-tilt>
        <div class="thumb" style="--thumb:url('assets/services/onestop.jpg');" role="img" aria-label="調査から施工まで一貫対応の写真"></div>
        <div class="body">
          <h4>アフターサービス</h4>
          <p>10年保証、2年間清掃サービスなど手厚いアフターサービス</p>
        </div>
      </article>
    </div>
  </section>

  <!-- ====== ABOUT ====== -->
  <section id="about" class="wrap">
    <div class="section-head">
      <div>
        <h3>会社概要</h3>
        <p>地域に根ざし、誠実に、丁寧に。価値が長続きする住まいづくりを目指しています。</p>
      </div>
      <span class="tag">ABOUT</span>
    </div>

    <div class="about">
      <div class="panel reveal">
        <div class="kv">
          <img src="assets/ogura-logo.png" alt="ロゴ" style="width: 150px; height: auto;">
          <div></div>
        </div>
        <div class="data">
          <div class="item"><b>代表</b><small>（サンプル）</small></div>
          <div class="item"><b>所在地</b><small>（サンプル）兵庫県明石市</small></div>
          <div class="item"><b>設立</b><small>2025年</small></div>
          <div class="item"><b>事業</b><small>建築塗装／仮設足場／手形思い出外壁工事／タイムカプセル外壁工事／外装リフォーム全般</small></div>
        </div>
      </div>

      <div class="panel reveal">
        <h4 style="margin:0 0 10px;font-weight:900">私たちの姿勢</h4>
        <p style="color:rgba(159,177,170,.95);margin:0 0 14px;line-height:1.8">
          劣化診断、下地づくり、仕上げの美しさ。<br>
          “塗る”だけではなく、“守る”ための施工を。住まいの価値を長く保ちます。
        </p>
        <ul style="margin:0 0 0 1.2em;color:rgba(159,177,170,.95);line-height:1.9">
          <li>丁寧な現地調査と明瞭なお見積り</li>
          <li>素材・色・工法の事前合意形成</li>
          <li>足場・近隣配慮・安全管理の徹底</li>
          <li>引渡し後の点検・アフターサポート</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- ====== BLOG ====== -->
  <section id="blog" class="wrap">
    <div class="section-head">
      <div>
        <h3>みんなのブログ</h3>
        <p>画像・タイトル・本文を投稿して、施工の思い出やお知らせをシェアしましょう。</p>
      </div>
      <span class="tag">BLOG</span>
    </div>

    <div class="blog">
      <form id="postForm" class="panel reveal" novalidate>
        <h4 style="margin:0 0 10px;font-weight:900">新規投稿</h4>

        <!-- Dropzone -->
        <label>画像（任意）</label>
        <div id="dropzone" class="dropzone" role="button" tabindex="0" aria-label="画像をアップロード">
          <div class="dz-icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M7 16a4 4 0 0 1 0-8 5 5 0 0 1 9.6-1.3A3.6 3.6 0 1 1 18 16H7z" stroke="rgba(234,255,246,.9)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M12 11v7" stroke="rgba(234,255,246,.9)" stroke-width="1.6" stroke-linecap="round"/>
              <path d="M9.5 13.5 12 11l2.5 2.5" stroke="rgba(234,255,246,.9)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="dz-text">
            <b>画像をドラッグ&ドロップ</b>
            <small>またはタップして選択</small>
          </div>
          <div class="dz-preview" id="dzPreview"><span class="hint">No Image</span></div>
        </div>
        <input id="postImage" name="image" class="hidden-input" type="file" accept="image/*">

        <div style="margin-top:14px">
          <label for="postTitle">タイトル</label>
          <input id="postTitle" name="title" type="text" placeholder="タイトルを入力" required>
        </div>

        <div style="margin-top:14px">
          <label for="postText">本文</label>
          <textarea id="postText" name="text" placeholder="本文を入力" required></textarea>
        </div>

        <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn primary" type="submit">投稿する</button>
          <button id="btnReload" class="btn" type="button">最新を読み込む</button>
        </div>

        <p class="hint">
          ※ 投稿はSupabaseの <b>blog_posts</b> に保存され、画像はStorage（バケット <b>post-images</b>）へアップロードされます。<br>
          ※ Storage 側の書込み権限が無い場合はアップロードに失敗します（Storage policies をご確認ください）。
        </p>
      </form>

      <div class="reveal">
        <div class="post-list" id="postList" aria-live="polite" aria-busy="false"></div>
        <div class="more">
          <button id="btnMore" class="btn ghost" type="button" hidden>もっと見る</button>
        </div>
      </div>
    </div>
  </section>

  <!-- ====== CONTACT ====== -->
  <section id="contact" class="wrap">
    <div class="section-head">
      <div>
        <h3>お問い合わせ</h3>
        <p>ご相談・お見積り・現調のご依頼など、下記よりお気軽にご連絡ください。</p>
      </div>
      <span class="tag">CONTACT</span>
    </div>

    <div class="contact-grid">
      <div class="panel reveal">
        <h4 style="margin:0 0 10px;font-weight:900">電話・メール</h4>
        <p class="hint" style="margin:0 0 10px">※ ダミーです。正式な連絡先に差し替えてください。</p>
        <p style="margin:0 0 14px;line-height:1.8">
          Tel：078-000-0000<br>
          Mail：info@example.jp
        </p>
        <a class="btn ghost" href="mailto:info@example.jp?subject=%E3%80%90%E3%81%8A%E5%95%8F%E3%81%84%E5%90%88%E3%82%8F%E3%81%9B%E3%80%91%E3%82%B5%E3%82%A4%E3%83%88%E7%9B%B8%E8%AB%87">メールを送る</a>
      </div>

      <div class="panel reveal">
        <h4 style="margin:0 0 10px;font-weight:900">対応エリア</h4>
        <p class="hint" style="margin:0 0 10px">兵庫・大阪を中心に関西一円。その他地域もご相談ください。</p>
        <p style="color:rgba(159,177,170,.95);margin:0;line-height:1.8">
          現地調査からご提案・お見積りまで無料で対応いたします。
        </p>
      </div>
    </div>
  </section>

  <!-- ====== FOOTER ====== -->
  <footer>
    <div class="foot">
      <div class="mini">
        <img src="assets/ogura-logo.png" alt="ロゴ" style="width: 150px; height: auto;">
        <div>
          <span class="copyright">© <span id="y"></span> つながりリフォームバトン工房. All rights reserved.</span>
        </div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <a class="tag" href="#privacy">プライバシーポリシー</a>
        <a class="tag" href="#terms">特定商取引法に基づく表記</a>
      </div>
    </div>
  </footer>

  <!-- Supabase CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script>

    // ========================
    //  設定：Supabase 接続情報
    // ========================
    const SUPABASE_URL = 'https://iokuochhrkizhyvlwszv.supabase.co';     // ←差し替え
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlva3VvY2hocmtpemh5dmx3c3p2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAwNTIzMjksImV4cCI6MjA2NTYyODMyOX0.NjTLvYrMyAXEgMYhohtFh9b8sN8qpyOSxLk2RzLOUPA';                   // ←差し替え
    const BUCKET = 'post-images';                             // Storage バケット名（Public）
    const { createClient } = supabase;
    const sb = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // ===== Helpers =====
    const $ = (q, el=document) => el.querySelector(q);
    const $$ = (q, el=document) => [...el.querySelectorAll(q)];
    const reduceMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const canHover = window.matchMedia('(hover: hover)').matches;

    // ===== Toast =====
    const toast = document.getElementById('toast');
    let toastTimer = null;
    function showToast(msg, type='ok'){
      if(!toast) return;
      toast.textContent = msg;
      toast.dataset.type = type;
      toast.classList.add('show');
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=>toast.classList.remove('show'), 2600);
    }

    // ===== Scroll progress =====
    const progressBar = document.getElementById('progressBar');
    function updateProgress(){
      const doc = document.documentElement;
      const max = doc.scrollHeight - doc.clientHeight;
      const cur = doc.scrollTop || window.scrollY || 0;
      const p = max > 0 ? (cur / max) : 0;
      progressBar.style.width = (p * 100).toFixed(2) + '%';
    }
    window.addEventListener('scroll', updateProgress, {passive:true});
    window.addEventListener('resize', updateProgress);
    updateProgress();

    // ===== Cursor glow =====
    const glow = document.getElementById('cursorGlow');
    if(glow && canHover && !reduceMotion){
      glow.style.opacity = '.95';
      let gx = window.innerWidth/2, gy = window.innerHeight/2;
      let tx = gx, ty = gy;

      window.addEventListener('pointermove', (e)=>{
        tx = e.clientX; ty = e.clientY;
      }, {passive:true});

      function tick(){
        gx += (tx - gx) * 0.12;
        gy += (ty - gy) * 0.12;
        glow.style.left = gx + 'px';
        glow.style.top  = gy + 'px';
        requestAnimationFrame(tick);
      }
      tick();
    }

    // ===== NAV (drawer + auto hide) =====
    const nav = document.getElementById('siteNav');
    const burger = document.getElementById('btnBurger');
    const mobile = document.getElementById('mobileMenu');
    const scrim = document.getElementById('scrim');
    const btnCloseDrawer = document.getElementById('btnCloseDrawer');

    function openMenu(){
      document.body.classList.add('menu-open');
      mobile.classList.add('open');
      mobile.removeAttribute('hidden');
      scrim.removeAttribute('hidden');
      burger.setAttribute('aria-expanded','true');
      setTimeout(()=>mobile.querySelector('a')?.focus(), 50);
    }
    function closeMenu(){
      document.body.classList.remove('menu-open');
      mobile.classList.remove('open');
      scrim.setAttribute('hidden','');
      burger.setAttribute('aria-expanded','false');
      setTimeout(()=>mobile.setAttribute('hidden',''), 350);
      burger.focus?.();
    }

    burger.addEventListener('click', ()=> mobile.classList.contains('open') ? closeMenu() : openMenu());
    btnCloseDrawer?.addEventListener('click', closeMenu);
    scrim.addEventListener('click', closeMenu);
    $$('#mobileMenu a').forEach(a=>a.addEventListener('click', closeMenu));
    document.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && mobile.classList.contains('open')) closeMenu(); });

    // Auto-hide header on mobile scroll
    let lastY = window.scrollY, ticking=false;
    function onScroll(){
      const y = window.scrollY;
      if(window.innerWidth <= 980 && !document.body.classList.contains('menu-open')){
        const down = y > lastY;
        if(y > 90 && down) nav.classList.add('nav--hide');
        else nav.classList.remove('nav--hide');
      }else{
        nav.classList.remove('nav--hide');
      }
      lastY = y;
      ticking=false;
    }
    window.addEventListener('scroll', ()=>{
      if(!ticking){ requestAnimationFrame(onScroll); ticking=true; }
    }, {passive:true});

    // ===== Smooth scroll offset =====
    document.querySelectorAll('a[href^="#"]').forEach(anchor=>{
      anchor.addEventListener('click', function(e){
        const id = this.getAttribute('href');
        if(id && id.length > 1){
          const el = document.querySelector(id);
          if(el){
            e.preventDefault();
            const y = el.getBoundingClientRect().top + window.scrollY - 78;
            window.scrollTo({top:y, behavior:'smooth'});
          }
        }
      });
    });

    // ===== Reveal on scroll =====
    const io = new IntersectionObserver(entries=>{
      entries.forEach(e=>{
        if(e.isIntersecting) e.target.classList.add('show');
      });
    }, {threshold:.16});
    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

    // ===== KPI count-up =====
    function easeOutCubic(t){ return 1 - Math.pow(1 - t, 3); }
    function animateCount(el, to, suffix){
      const dur = 900;
      const start = performance.now();
      function step(now){
        const p = Math.min((now - start)/dur, 1);
        const v = Math.floor(to * easeOutCubic(p));
        el.textContent = v + (suffix || '');
        if(p < 1) requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }
    const kpiObserver = new IntersectionObserver(entries=>{
      entries.forEach(e=>{
        if(!e.isIntersecting) return;
        const h = e.target.querySelector('h3[data-count]');
        if(h && !h.dataset.done){
          h.dataset.done = '1';
          const to = Number(h.dataset.count || 0);
          const suffix = h.dataset.suffix || '';
          animateCount(h, to, suffix);
        }
      });
    }, {threshold:.5});
    document.querySelectorAll('.kpi').forEach(k=>kpiObserver.observe(k));

    // ===== Tilt + highlight tracking =====
    function bindTilt(el){
      if(!canHover || reduceMotion) return;
      el.classList.add('tilt');
      el.addEventListener('pointermove', (ev)=>{
        const r = el.getBoundingClientRect();
        const px = (ev.clientX - r.left) / r.width;
        const py = (ev.clientY - r.top) / r.height;
        const dx = (px - 0.5);
        const dy = (py - 0.5);
        const ry = (dx * 10).toFixed(2);
        const rx = (-dy * 8).toFixed(2);
        el.style.setProperty('--rx', rx + 'deg');
        el.style.setProperty('--ry', ry + 'deg');
        el.style.setProperty('--mx', (px*100).toFixed(2) + '%');
        el.style.setProperty('--my', (py*100).toFixed(2) + '%');
      });
      el.addEventListener('pointerleave', ()=>{
        el.style.setProperty('--rx','0deg');
        el.style.setProperty('--ry','0deg');
      });
    }
    document.querySelectorAll('[data-tilt]').forEach(bindTilt);

    // KPI cards also track highlight
    document.querySelectorAll('.kpi').forEach(el=>{
      if(!canHover) return;
      el.addEventListener('pointermove', (ev)=>{
        const r = el.getBoundingClientRect();
        const px = (ev.clientX - r.left) / r.width;
        const py = (ev.clientY - r.top) / r.height;
        el.style.setProperty('--mx', (px*100).toFixed(2) + '%');
        el.style.setProperty('--my', (py*100).toFixed(2) + '%');
      });
    });

    // ===== Footer year =====
    document.getElementById('y').textContent = new Date().getFullYear();

    // ==========================
    //  HERO Canvas particles FX
    // ==========================
    function initHeroFx(){
      if(reduceMotion) return;
      const canvas = document.getElementById('fx');
      if(!canvas) return;
      const ctx = canvas.getContext('2d', { alpha:true });
      if(!ctx) return;

      let w=0, h=0, dpr=1;
      let running = true;
      const particles = [];

      const maxDpr = 2;
      function resize(){
        const rect = canvas.getBoundingClientRect();
        w = Math.max(1, rect.width);
        h = Math.max(1, rect.height);
        dpr = Math.min(window.devicePixelRatio || 1, maxDpr);
        canvas.width = Math.floor(w*dpr);
        canvas.height = Math.floor(h*dpr);
        ctx.setTransform(dpr,0,0,dpr,0,0);
      }

      function seed(){
        particles.length = 0;
        const count = window.innerWidth < 600 ? 34 : 56;
        for(let i=0;i<count;i++){
          particles.push({
            x: Math.random()*w,
            y: Math.random()*h,
            vx: (Math.random()-.5) * 0.35,
            vy: (Math.random()-.5) * 0.35,
            r: Math.random()*1.6 + 0.7
          });
        }
      }

      const mouse = {x: w*0.5, y: h*0.4, active:false};
      canvas.addEventListener('pointermove', (e)=>{
        const r = canvas.getBoundingClientRect();
        mouse.x = e.clientX - r.left;
        mouse.y = e.clientY - r.top;
        mouse.active = true;
      });
      canvas.addEventListener('pointerleave', ()=> mouse.active = false);

      function draw(){
        if(!running) return;
        ctx.clearRect(0,0,w,h);

        // soft vignette
        const g = ctx.createRadialGradient(w*0.5, h*0.35, 40, w*0.5, h*0.35, Math.max(w,h)*0.65);
        g.addColorStop(0, 'rgba(34,243,166,0.05)');
        g.addColorStop(1, 'rgba(0,0,0,0)');
        ctx.fillStyle = g;
        ctx.fillRect(0,0,w,h);

        // update + draw connections
        const maxDist = 140;
        for(const p of particles){
          if(mouse.active){
            const dx = mouse.x - p.x;
            const dy = mouse.y - p.y;
            const dist = Math.hypot(dx,dy);
            if(dist < 180){
              p.vx += dx/dist * 0.002;
              p.vy += dy/dist * 0.002;
            }
          }

          p.x += p.vx;
          p.y += p.vy;

          if(p.x < -20) p.x = w+20;
          if(p.x > w+20) p.x = -20;
          if(p.y < -20) p.y = h+20;
          if(p.y > h+20) p.y = -20;
        }

        for(let i=0;i<particles.length;i++){
          for(let j=i+1;j<particles.length;j++){
            const a = particles[i], b = particles[j];
            const dx = a.x - b.x;
            const dy = a.y - b.y;
            const dist = Math.hypot(dx,dy);
            if(dist < maxDist){
              const alpha = (1 - dist/maxDist) * 0.18;
              ctx.strokeStyle = `rgba(34,243,166,${alpha})`;
              ctx.lineWidth = 1;
              ctx.beginPath();
              ctx.moveTo(a.x,a.y);
              ctx.lineTo(b.x,b.y);
              ctx.stroke();
            }
          }
        }

        // points
        for(const p of particles){
          ctx.fillStyle = 'rgba(234,255,246,.55)';
          ctx.beginPath();
          ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
          ctx.fill();
        }

        requestAnimationFrame(draw);
      }

      resize();
      seed();
      draw();

      window.addEventListener('resize', ()=>{
        resize(); seed();
      });

      document.addEventListener('visibilitychange', ()=>{
        if(document.visibilityState === 'hidden'){
          running = false;
        }else{
          running = true;
          resize();
          seed();
          requestAnimationFrame(draw);
        }
      });
    }
    initHeroFx();

    // ==========================
    //  Blog: Supabase CRUD + UI
    // ==========================
    const PAGE_SIZE = 12;
    let loadedCount = 0;

    const postForm = document.getElementById('postForm');
    const postList = document.getElementById('postList');
    const btnMore = document.getElementById('btnMore');
    const btnReload = document.getElementById('btnReload');

    const dropzone = document.getElementById('dropzone');
    const postImage = document.getElementById('postImage');
    const dzPreview = document.getElementById('dzPreview');

    function escapeHTML(str){
      return (str || '').replace(/[&<>"']/g, s=>({
        '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'
      })[s]);
    }
    const newID = () => (crypto && crypto.randomUUID) ? crypto.randomUUID() : ('id-' + Date.now() + '-' + Math.random().toString(16).slice(2));

    function renderPreview(file){
      if(!file){
        dzPreview.innerHTML = '<span class="hint">No Image</span>';
        return;
      }
      const url = URL.createObjectURL(file);
      dzPreview.innerHTML = `<img src="${url}" alt="preview">`;
    }

    function attachFileToInput(file){
      // DataTransfer を使って input.files を差し替える（対応ブラウザで）
      try{
        const dt = new DataTransfer();
        dt.items.add(file);
        postImage.files = dt.files;
      }catch(e){
        // 一部ブラウザで不可の場合があるため、プレビューだけは表示
      }
      renderPreview(file);
    }

    dropzone.addEventListener('click', ()=> postImage.click());
    dropzone.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') postImage.click(); });

    postImage.addEventListener('change', ()=>{
      const file = postImage.files && postImage.files[0];
      renderPreview(file);
    });

    // Drag & Drop
    ['dragenter','dragover'].forEach(evt=>{
      dropzone.addEventListener(evt, (e)=>{
        e.preventDefault(); e.stopPropagation();
        dropzone.style.borderColor = 'rgba(34,243,166,.55)';
      });
    });
    ['dragleave','drop'].forEach(evt=>{
      dropzone.addEventListener(evt, (e)=>{
        e.preventDefault(); e.stopPropagation();
        dropzone.style.borderColor = 'rgba(255,255,255,.22)';
      });
    });
    dropzone.addEventListener('drop', (e)=>{
      const file = e.dataTransfer?.files?.[0];
      if(file && file.type.startsWith('image/')){
        attachFileToInput(file);
      }else{
        showToast('画像ファイルをドロップしてください。', 'error');
      }
    });

    async function uploadImageToStorage(file){
      if(!file) return null;

      // サイズ制限（必要に応じて変更）
      const maxSize = 5 * 1024 * 1024; // 5MB
      if(file.size > maxSize){
        throw new Error('画像サイズが大きすぎます（5MB以下推奨）。');
      }

      const ext = (file.name.split('.').pop() || 'jpg').toLowerCase();
      const path = `blog/${newID()}.${ext}`;

      const { error } = await sb.storage.from(BUCKET).upload(path, file, {
        cacheControl: '3600',
        upsert: false,
        contentType: file.type || 'image/jpeg'
      });
      if(error) throw error;

      const { data:pub } = sb.storage.from(BUCKET).getPublicUrl(path);
      return pub?.publicUrl || null;
    }

    async function insertPost({title, body, imageUrl}){
      const { data, error } = await sb
        .from('blog_posts')
        .insert({ title, body, image_url: imageUrl })
        .select()
        .single();
      if(error) throw error;
      return data;
    }

    function fmtDate(iso){
      const dt = new Date(iso);
      const y = dt.getFullYear();
      const m = String(dt.getMonth()+1).padStart(2,'0');
      const d = String(dt.getDate()).padStart(2,'0');
      const hh = String(dt.getHours()).padStart(2,'0');
      const mm = String(dt.getMinutes()).padStart(2,'0');
      return `${y}/${m}/${d} ${hh}:${mm}`;
    }

    function cardHTML(p){
      const img = p.image_url
        ? `<img src="${p.image_url}" alt="${escapeHTML(p.title)}">`
        : `<span class="hint" style="padding:10px">No Image</span>`;

      return `
        <article class="post tilt" data-tilt>
          <div class="ph">${img}</div>
          <div class="body">
            <h5 class="title">${escapeHTML(p.title)}</h5>
            <p class="text">${escapeHTML(p.body || '')}</p>
            <div class="meta">投稿日時：${fmtDate(p.created_at)}</div>
          </div>
        </article>
      `;
    }

    function renderSkeleton(count=6){
      postList.innerHTML = '';
      for(let i=0;i<count;i++){
        const el = document.createElement('div');
        el.className = 'post skeleton';
        el.innerHTML = `
          <div class="ph"></div>
          <div class="body">
            <div class="title">----</div>
            <div class="text">----</div>
            <div class="meta">----</div>
          </div>
        `;
        postList.appendChild(el);
      }
    }

    async function fetchPosts({append=false}={}){
      postList.setAttribute('aria-busy','true');
      if(!append) renderSkeleton(6);

      const from = append ? loadedCount : 0;
      const to   = from + PAGE_SIZE - 1;

      const { data, error, count } = await sb
        .from('blog_posts')
        .select('*', { count:'exact' })
        .order('created_at', { ascending:false })
        .range(from, to);

      if(error){
        console.error(error);
        postList.innerHTML = `<p class="hint">投稿の取得に失敗しました。SUPABASE_URL / ANON_KEY やポリシーをご確認ください。</p>`;
        btnMore.hidden = true;
        postList.setAttribute('aria-busy','false');
        showToast('投稿の取得に失敗しました。', 'error');
        return;
      }

      if(!append){
        postList.innerHTML = '';
        loadedCount = 0;
      }

      const frag = document.createDocumentFragment();
      (data || []).forEach(p=>{
        const wrap = document.createElement('div');
        wrap.innerHTML = cardHTML(p);
        frag.appendChild(wrap.firstElementChild);
      });
      postList.appendChild(frag);

      // チルト再バインド（動的に追加された投稿）
      postList.querySelectorAll('[data-tilt]').forEach(bindTilt);

      loadedCount += (data || []).length;
      btnMore.hidden = !(count && loadedCount < count);

      postList.setAttribute('aria-busy','false');
    }

    postForm.addEventListener('submit', async (ev)=>{
      ev.preventDefault();
      const title = (postForm.title.value || '').trim();
      const body  = (postForm.text.value  || '').trim();
      const file  = postImage.files && postImage.files[0];

      if(!title || !body){
        showToast('タイトルと本文は必須です。', 'error');
        return;
      }

      try{
        showToast('投稿中…', 'ok');
        const imageUrl = await uploadImageToStorage(file);
        await insertPost({ title, body, imageUrl });

        postForm.reset();
        dzPreview.innerHTML = '<span class="hint">No Image</span>';

        showToast('投稿しました！', 'ok');
        await fetchPosts({append:false});
      }catch(err){
        console.error(err);
        showToast('投稿に失敗しました（Storage権限/通信/設定を確認）。', 'error');
      }
    });

    btnMore.addEventListener('click', ()=>fetchPosts({append:true}));
    btnReload.addEventListener('click', ()=>fetchPosts({append:false}));

    // 初期ロード
    fetchPosts({append:false});

  </script>
</body>
</html>
